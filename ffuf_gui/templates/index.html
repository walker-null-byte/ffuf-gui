<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FFUF GUI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="dark-theme">
    <header>
        <div class="brand">FFUF GUI</div>
        <!-- Top bar quick config -->
        <form id="config-form">
            <div class="header-row">
                <div class="input-group" style="flex: 3; min-width: 300px;">
                    <label>Target URL:</label>
                    <input type="text" name="url" placeholder="https://site.com/FUZZ" required>
                </div>

                <div class="input-group" style="width: 100px;">
                    <label>Method:</label>
                    <select name="method">
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="DELETE">DELETE</option>
                        <option value="HEAD">HEAD</option>
                        <option value="OPTIONS">OPTIONS</option>
                    </select>
                </div>

                <div class="input-group" style="width: 80px;">
                    <label>Threads:</label>
                    <input type="number" name="threads" value="40">
                </div>

                <div class="input-group" style="width: 80px;">
                    <label>Timeout:</label>
                    <input type="number" name="timeout" value="10">
                </div>
            </div>
    </header>

    <main>
        <!-- Left Panel: Settings -->
        <aside class="config-panel">

            <!-- Section: Wordlists -->
            <div class="section-header">
                <span class="section-icon">üìÇ</span> Wordlists
            </div>
            <div class="section-content">
                <p style="font-size: 0.8em; color: #888; margin-bottom: 8px;">Use FUZZ in URL where wordlist values
                    should be substituted</p>
                <div id="wordlist-container">
                    <div class="wordlist-row wordlist-item">
                        <input type="text" name="wl_path_0" placeholder="Click Browse or paste full path"
                            class="wl-path" style="flex: 1;">
                        <button type="button" class="btn-browse" data-target="wl_path_0">üìÇ</button>
                        <input type="text" name="wl_key_0" value="FUZZ" placeholder="Key" class="wl-key">
                    </div>
                </div>
                <button type="button" id="add-wordlist" class="btn-add">[+] Add wordlist</button>
                <div style="margin-top: 5px;">
                    <a href="https://github.com/danielmiessler/SecLists" target="_blank"
                        style="font-size: 0.85em; color: #34d0ec; text-decoration: none;">Download wordlists</a>
                </div>
            </div>

            <!-- Section: Headers -->
            <div class="section-header">
                <span class="section-icon">üîí</span> Headers / Auth
            </div>
            <div class="section-content h-100">
                <textarea name="headers" rows="4" placeholder="Cookie: val=1&#10;Authorization: Bearer ..."></textarea>
                <label>POST Data:</label>
                <textarea name="data" rows="2" placeholder="param1=value1&param2=FUZZ"></textarea>
            </div>

            <!-- Section: Matchers -->
            <div class="section-header">
                <span class="section-icon">üéØ</span> Matchers
            </div>
            <div class="section-content">
                <div class="input-group">
                    <label>Status Codes:</label>
                    <input type="text" name="mc" placeholder="200,204,301">
                </div>
                <div class="inline-inputs">
                    <div class="input-group">
                        <label>Size:</label>
                        <input type="text" name="ms">
                    </div>
                    <div class="input-group">
                        <label>Words:</label>
                        <input type="text" name="mw">
                    </div>
                    <div class="input-group">
                        <label>Lines:</label>
                        <input type="text" name="ml">
                    </div>
                </div>
                <div class="input-group">
                    <label>Regex:</label>
                    <input type="text" name="mr">
                </div>
            </div>

            <!-- Section: Filters -->
            <div class="section-header">
                <span class="section-icon">üö´</span> Filters
            </div>
            <div class="section-content">
                <div class="input-group">
                    <label>Status Codes:</label>
                    <input type="text" name="fc" placeholder="404">
                </div>
                <!-- Simplified size/word/line filters for compact view -->
                <div class="inline-inputs">
                    <div class="input-group">
                        <label>Size:</label>
                        <input type="text" name="fs">
                    </div>
                    <div class="input-group">
                        <label>Words:</label>
                        <input type="text" name="fw">
                    </div>
                </div>
            </div>

            <!-- Section: Advanced -->
            <div class="section-header">
                <span class="section-icon">‚öôÔ∏è</span> Advanced
            </div>
            <div class="section-content">
                <label class="checkbox-row">
                    <input type="checkbox" name="recursion" id="recursion">
                    <span>Recursion</span>
                </label>
                <label class="checkbox-row">
                    <input type="checkbox" name="follow_redirects" id="follow_redirects">
                    <span>Follow Redirects (-r)</span>
                </label>
                <label class="checkbox-row">
                    <input type="checkbox" name="ignore_body" id="ignore_body">
                    <span>Ignore Body</span>
                </label>
                <div class="input-group">
                    <label>Recursion Depth:</label>
                    <input type="number" name="recursion_depth" value="0">
                </div>
            </div>

            <!-- Section: Output Options -->
            <div class="section-header">
                <span class="section-icon">üì§</span> Output Options
            </div>
            <div class="section-content">
                <div class="input-group">
                    <label>Output File (optional):</label>
                    <div class="wordlist-item">
                        <input type="text" name="output_file" placeholder="Path to save results" class="wl-path"
                            style="flex: 1;">
                        <button type="button" class="btn-browse-save" id="browse-output">üìÇ</button>
                    </div>
                </div>
                <div class="input-group">
                    <label>Output Format:</label>
                    <select name="output_format">
                        <option value="">Default (no file output)</option>
                        <option value="json">JSON (-of json)</option>
                        <option value="ejson">EJSON - Event JSON (-of ejson)</option>
                        <option value="html">HTML (-of html)</option>
                        <option value="md">Markdown (-of md)</option>
                        <option value="csv">CSV (-of csv)</option>
                        <option value="all">All formats (-of all)</option>
                    </select>
                </div>
                <label class="checkbox-row">
                    <input type="checkbox" name="silent" id="silent">
                    <span>Silent Mode (-s) - No progress output</span>
                </label>
                <label class="checkbox-row">
                    <input type="checkbox" name="verbose" id="verbose">
                    <span>Verbose (-v) - Show full URLs</span>
                </label>
                <label class="checkbox-row">
                    <input type="checkbox" name="colors" id="colors" checked>
                    <span>Colors (-c) - Enable colored output</span>
                </label>
            </div>

        </aside> <!-- End Left Panel -->

        <!-- Right Panel: Output -->
        <section class="output-panel">
            <div class="output-header">
                <span>Output Stream</span>
                <span id="stats-area">Req/s: 0</span>
            </div>

            <!-- Live Log Output -->
            <div id="log-output-container" class="log-container">
                <div class="log-header">Live Log</div>
                <pre id="log-output"></pre>
            </div>

            <div id="results-table-container">
                <table id="results-table">
                    <thead>
                        <tr>
                            <th>Status</th>
                            <th>Size</th>
                            <th>Words</th>
                            <th>Lines</th>
                            <th>Payload</th>
                            <th>Type</th>
                        </tr>
                    </thead>
                    <tbody id="results-body">
                        <!-- Results here -->
                    </tbody>
                </table>
            </div>
        </section>
        </form>

    </main>

    <!-- Bottom Footer Controls -->
    <div class="footer-panel">
        <div class="cmd-preview-box">
            <span class="cmd-preview-label">Generated Command</span>
            <div id="command-preview">ffuf</div>
        </div>

        <div class="controls-row">
            <span class="controls-label">Controls</span>

            <button id="btn-run" class="btn-control btn-start">
                <span>‚ñ∂</span> Start
            </button>

            <button id="btn-stop" class="btn-control btn-stop">
                <span>‚ñ†</span> Stop
            </button>

            <button id="clear-log" class="btn-control" style="margin-left: auto;">
                <span>üßπ</span> Clear Output
            </button>

            <div id="status-indicator" class="status idle" style="display:none">Idle</div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>

</html>